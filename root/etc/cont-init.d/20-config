#!/bin/bash

set -ex

PUID=${PUID:-0}
PGID=${PGID:-0}

# make folders
mkdir -p \
	/config \
	/downloads/complete \
	/downloads/incomplete \
	/watch

# copy config
[[ ! -f /config/settings.json ]] && cp \
	/defaults/settings.json /config/settings.json

# copy blocklist-update script
[[ ! -f /config/blocklist-update.sh ]] && cp \
	/defaults/blocklist-update.sh /config/blocklist-update.sh

# copy settings for gdfuse
[[ ! -f /config/.gdfuse/$LABEL/config ]] && cp \
	/defaults/gdrive-config /config/.gdfuse/$LABEL/config

# permissions
chown -R abc:abc /config /downloads /watch
chmod 755 /config/blocklist-update.sh
